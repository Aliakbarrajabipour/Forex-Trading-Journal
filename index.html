<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>آکادمی آموزش ترید علی - ژورنال حرفه ای معاملاتی فارکس- لینک پیج آموزش وارتباط با ما در پایین صفحه</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary: #D4AF37;
            --primary-dark: #B8941F;
            --secondary: #1a1a1a;
            --light: #f8f9fa;
            --dark: #212529;
            --success: #28a745;
            --danger: #dc3545;
            --warning: #ffc107;
            --info: #17a2b8;
            --border: #dee2e6;
            --bg-light: #f5f5f5;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Vazirmatn', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: var(--bg-light);
            color: var(--dark);
            line-height: 1.6;
            padding: 0;
            min-height: 100vh;
        }
        
        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
        }
        
        header {
            background: linear-gradient(135deg, var(--secondary) 0%, #2c2c2c 100%);
            color: white;
            padding: 15px 0;
            border-bottom: 4px solid var(--primary);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .header-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            gap: 10px;
        }
        
        .academy-title {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            margin-bottom: 10px;
        }
        
        .academy-title h1 {
            font-size: 22px;
            color: var(--primary);
            margin: 0;
        }
        
        .academy-title .subtitle {
            font-size: 14px;
            color: #ccc;
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .instagram-logo {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid var(--primary);
        }
        
        .symbol-badge {
            background: var(--primary);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .settings-panel {
            background: white;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            margin: 15px auto;
            border-top: 4px solid var(--primary);
            width: 100%;
        }
        
        .settings-row {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin: 15px auto;
        }
        
        .stat-card {
            background: white;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            text-align: center;
            border-top: 4px solid var(--primary);
        }
        
        .stat-card h3 {
            font-size: 12px;
            color: #666;
            margin-bottom: 8px;
        }
        
        .stat-card .value {
            font-size: 18px;
            font-weight: bold;
        }
        
        .profit {
            color: var(--success);
        }
        
        .loss {
            color: var(--danger);
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            margin: 15px auto;
        }
        
        .form-section, .trades-section, .analysis-section, .advanced-analysis {
            background: white;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            margin-bottom: 15px;
        }
        
        .section-title {
            font-size: 16px;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid var(--primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .section-title i {
            color: var(--primary);
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            font-size: 14px;
        }
        
        input, select, textarea, button {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border);
            border-radius: 5px;
            font-size: 14px;
        }
        
        textarea {
            height: 70px;
            resize: vertical;
        }
        
        button {
            background-color: var(--primary);
            color: white;
            border: none;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        
        button:hover {
            background-color: var(--primary-dark);
        }
        
        .trade-type {
            display: flex;
            gap: 8px;
            margin-bottom: 15px;
        }
        
        .trade-type-btn {
            flex: 1;
            text-align: center;
            padding: 10px;
            border: 2px solid var(--border);
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            font-size: 14px;
        }
        
        .trade-type-btn.active {
            border-color: var(--primary);
            background-color: rgba(212, 175, 55, 0.1);
        }
        
        .buy-btn.active {
            color: var(--success);
            border-color: var(--success);
        }
        
        .sell-btn.active {
            color: var(--danger);
            border-color: var(--danger);
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            font-size: 12px;
        }
        
        th, td {
            padding: 8px 5px;
            text-align: center;
            border-bottom: 1px solid var(--border);
        }
        
        th {
            background-color: #f8f9fa;
            font-weight: 600;
            position: sticky;
            top: 0;
            font-size: 11px;
        }
        
        tr:hover {
            background-color: #f8f9fa;
        }
        
        .action-btn {
            padding: 4px 8px;
            margin: 0 2px;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            width: auto;
            font-size: 12px;
        }
        
        .edit-btn {
            background-color: var(--info);
            color: white;
        }
        
        .delete-btn {
            background-color: var(--danger);
            color: white;
        }
        
        .buy-badge {
            background-color: var(--success);
            color: white;
            padding: 3px 6px;
            border-radius: 3px;
            font-size: 10px;
            font-weight: bold;
        }
        
        .sell-badge {
            background-color: var(--danger);
            color: white;
            padding: 3px 6px;
            border-radius: 3px;
            font-size: 10px;
            font-weight: bold;
        }
        
        .analysis-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }
        
        .analysis-card {
            background: #f8f9fa;
            border-radius: 6px;
            padding: 10px;
            text-align: center;
            border-left: 4px solid var(--primary);
        }
        
        .analysis-card h4 {
            font-size: 11px;
            color: #666;
            margin-bottom: 5px;
        }
        
        .analysis-card .value {
            font-size: 14px;
            font-weight: bold;
        }
        
        .chart-container {
            height: 200px;
            margin-top: 15px;
            background: #f8f9fa;
            border-radius: 6px;
            padding: 10px;
            border: 1px solid var(--border);
        }
        
        footer {
            text-align: center;
            margin-top: 20px;
            padding: 15px;
            color: #666;
            font-size: 12px;
            border-top: 1px solid var(--border);
        }
        
        .creator-info {
            background: var(--primary);
            color: white;
            padding: 10px;
            border-radius: 6px;
            margin-top: 15px;
            text-align: center;
        }
        
        .creator-info a {
            color: white;
            text-decoration: none;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
            font-size: 12px;
        }
        
        .creator-info a:hover {
            text-decoration: underline;
        }
        
        .instagram-icon {
            color: white;
            font-size: 14px;
        }
        
        .empty-state {
            text-align: center;
            padding: 30px 15px;
            color: #666;
        }
        
        .empty-state i {
            font-size: 40px;
            margin-bottom: 10px;
            color: #ccc;
        }
        
        .export-import {
            display: flex;
            gap: 8px;
            margin-top: 15px;
        }
        
        .export-btn, .import-btn {
            flex: 1;
            padding: 8px;
            font-size: 12px;
        }
        
        .export-btn {
            background-color: var(--success);
        }
        
        .import-btn {
            background-color: var(--info);
        }
        
        .file-input {
            display: none;
        }
        
        .help-text {
            font-size: 10px;
            color: #666;
            margin-top: 3px;
        }
        
        .performance-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }
        
        .metric-card {
            background: #f8f9fa;
            border-radius: 6px;
            padding: 10px;
            text-align: center;
        }
        
        .metric-card h4 {
            font-size: 11px;
            color: #666;
            margin-bottom: 5px;
        }
        
        .metric-card .value {
            font-size: 14px;
            font-weight: bold;
        }
        
        .tabs {
            display: flex;
            margin-bottom: 15px;
            border-bottom: 1px solid var(--border);
            overflow-x: auto;
        }
        
        .tab {
            padding: 8px 12px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
            white-space: nowrap;
            font-size: 12px;
        }
        
        .tab.active {
            border-bottom-color: var(--primary);
            color: var(--primary);
            font-weight: bold;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .risk-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }

        /* Media Queries for larger screens */
        @media (min-width: 768px) {
            .container {
                padding: 0 20px;
            }
            
            header {
                padding: 20px 0;
            }
            
            .header-content {
                flex-direction: row;
                justify-content: space-between;
                text-align: left;
            }
            
            .academy-title {
                align-items: flex-start;
                margin-bottom: 0;
            }
            
            .academy-title h1 {
                font-size: 24px;
            }
            
            .academy-title .subtitle {
                font-size: 16px;
            }
            
            .instagram-logo {
                width: 50px;
                height: 50px;
            }
            
            .settings-panel {
                padding: 20px;
                margin: 20px auto;
            }
            
            .settings-row {
                grid-template-columns: 1fr 1fr;
                gap: 20px;
            }
            
            .dashboard {
                grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
                gap: 15px;
                margin: 20px auto;
            }
            
            .stat-card {
                padding: 20px;
            }
            
            .stat-card h3 {
                font-size: 14px;
            }
            
            .stat-card .value {
                font-size: 22px;
            }
            
            .main-content {
                grid-template-columns: 1fr 1fr;
                gap: 20px;
                margin: 20px auto;
            }
            
            .form-section, .trades-section, .analysis-section, .advanced-analysis {
                padding: 20px;
                margin-bottom: 20px;
            }
            
            .section-title {
                font-size: 18px;
                margin-bottom: 20px;
            }
            
            .form-row {
                grid-template-columns: 1fr 1fr;
                gap: 15px;
            }
            
            table {
                font-size: 14px;
            }
            
            th, td {
                padding: 10px 8px;
            }
            
            th {
                font-size: 12px;
            }
            
            .analysis-cards, .performance-metrics, .risk-metrics {
                grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
                gap: 15px;
            }
            
            .chart-container {
                height: 250px;
            }
        }

        @media (min-width: 1200px) {
            .dashboard {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            }
            
            .analysis-cards, .performance-metrics, .risk-metrics {
                grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            }
            
            .chart-container {
                height: 300px;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <div class="academy-title">
                    <h1>آکادمی آموزش ترید علی</h1>
                    <div class="subtitle">ژورنال حرفه ای معاملات فارکس</div>
                </div>
                <div class="logo-container">
                    <img src="https://www.upload.ee/image/18853885/bf3f34fb-c3df-4c17-91ea-a7ae481e0267.jpg" 
                         alt="آکادمی آموزش ترید علی" 
                         class="instagram-logo">
                    <div class="symbol-badge" id="current-symbol">XAU/USD</div>
                </div>
            </div>
        </div>
    </header>
    
    <div class="container">
        <div class="settings-panel">
            <h2 class="section-title">
                <i class="fas fa-cog"></i>
                تنظیمات حساب
            </h2>
            <div class="settings-row">
                <div class="form-group">
                    <label for="initial-balance">بالانس اولیه حساب ($)</label>
                    <input type="number" id="initial-balance" min="0" step="0.01" value="10000">
                </div>
                <div class="form-group">
                    <label for="account-currency">ارز حساب</label>
                    <select id="account-currency">
                        <option value="USD">دلار آمریکا (USD)</option>
                    </select>
                </div>
            </div>
            <div class="settings-row">
                <div class="form-group">
                    <label for="default-symbol">جفت ارز پیشفرض</label>
                    <select id="default-symbol">
                        <option value="XAU/USD">XAU/USD (طلای جهانی)</option>
                        <option value="EUR/USD">EUR/USD (یورو/دلار)</option>
                        <option value="GBP/USD">GBP/USD (پوند/دلار)</option>
                        <option value="USD/JPY">USD/JPY (دلار/ین)</option>
                        <option value="USD/CHF">USD/CHF (دلار/فرانک)</option>
                        <option value="AUD/USD">AUD/USD (دلار استرالیا/دلار)</option>
                        <option value="USD/CAD">USD/CAD (دلار/دلار کانادا)</option>
                        <option value="NZD/USD">NZD/USD (دلار نیوزلند/دلار)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="risk-per-trade">ریسک پیشفرض هر معامله (%)</label>
                    <input type="number" id="risk-per-trade" min="0.1" max="10" step="0.1" value="1">
                </div>
            </div>
            <button id="save-settings">
                <i class="fas fa-save"></i> ذخیره تنظیمات
            </button>
        </div>
        
        <div class="dashboard">
            <div class="stat-card">
                <h3>تعداد معاملات</h3>
                <div class="value" id="total-trades">0</div>
            </div>
            <div class="stat-card">
                <h3>سود/زیان خالص</h3>
                <div class="value" id="net-profit">$0.00</div>
            </div>
            <div class="stat-card">
                <h3>موجودی حساب</h3>
                <div class="value" id="current-balance">$10,000.00</div>
            </div>
            <div class="stat-card">
                <h3>میانگین سود/معامله</h3>
                <div class="value" id="avg-profit">$0.00</div>
            </div>
        </div>
        
        <div class="main-content">
            <div>
                <div class="form-section">
                    <h2 class="section-title">
                        <i class="fas fa-plus-circle"></i>
                        ثبت معامله جدید
                    </h2>
                    
                    <div class="form-group">
                        <label for="symbol">جفت ارز</label>
                        <select id="symbol">
                            <option value="XAU/USD">XAU/USD (طلای جهانی)</option>
                            <option value="EUR/USD">EUR/USD (یورو/دلار)</option>
                            <option value="GBP/USD">GBP/USD (پوند/دلار)</option>
                            <option value="USD/JPY">USD/JPY (دلار/ین)</option>
                            <option value="USD/CHF">USD/CHF (دلار/فرانک)</option>
                            <option value="AUD/USD">AUD/USD (دلار استرالیا/دلار)</option>
                            <option value="USD/CAD">USD/CAD (دلار/دلار کانادا)</option>
                            <option value="NZD/USD">NZD/USD (دلار نیوزلند/دلار)</option>
                        </select>
                    </div>
                    
                    <div class="trade-type">
                        <div class="trade-type-btn buy-btn active" data-type="buy">
                            <i class="fas fa-arrow-up"></i> خرید
                        </div>
                        <div class="trade-type-btn sell-btn" data-type="sell">
                            <i class="fas fa-arrow-down"></i> فروش
                        </div>
                    </div>
                    
                    <form id="trade-form">
                        <div class="form-group">
                            <label for="trade-date">تاریخ معامله</label>
                            <input type="datetime-local" id="trade-date" required>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="entry-price">قیمت ورود</label>
                                <input type="number" id="entry-price" step="0.00001" min="0" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="exit-price">قیمت خروج</label>
                                <input type="number" id="exit-price" step="0.00001" min="0" required>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="volume">حجم معامله (لات)</label>
                                <input type="number" id="volume" step="0.01" min="0.01" required>
                                <div class="help-text" id="volume-help">هر 0.01 لات = 1 دلار در هر پیپ</div>
                            </div>
                            
                            <div class="form-group">
                                <label for="leverage">اهرم</label>
                                <select id="leverage" required>
                                    <option value="1:1">1:1</option>
                                    <option value="1:10">1:10</option>
                                    <option value="1:50" selected>1:50</option>
                                    <option value="1:100">1:100</option>
                                    <option value="1:200">1:200</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="stop-loss">استاپ لاس</label>
                                <input type="number" id="stop-loss" step="0.00001" min="0">
                            </div>
                            
                            <div class="form-group">
                                <label for="take-profit">تیک پروفیت</label>
                                <input type="number" id="take-profit" step="0.00001" min="0">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="swap">سواپ (به دلار)</label>
                            <input type="number" id="swap" step="0.01" value="0">
                        </div>
                        
                        <div class="form-group">
                            <label for="commission">کمیسیون (به دلار)</label>
                            <input type="number" id="commission" step="0.01" value="0">
                        </div>
                        
                        <div class="form-group">
                            <label for="notes">یادداشت معامله</label>
                            <textarea id="notes" placeholder="علت ورود، استراتژی، احساسات و ..."></textarea>
                        </div>
                        
                        <button type="submit">
                            <i class="fas fa-save"></i> ثبت معامله
                        </button>
                    </form>
                    
                    <div class="export-import">
                        <button class="export-btn" id="export-btn">
                            <i class="fas fa-download"></i> ذخیره فایل
                        </button>
                        <button class="import-btn" id="import-btn">
                            <i class="fas fa-upload"></i> بارگذاری فایل
                        </button>
                        <input type="file" id="file-input" class="file-input" accept=".json">
                    </div>
                </div>
                
                <div class="analysis-section">
                    <h2 class="section-title">
                        <i class="fas fa-chart-pie"></i>
                        تحلیل عملکرد
                    </h2>
                    
                    <div class="analysis-cards">
                        <div class="analysis-card">
                            <h4>Win Rate</h4>
                            <div class="value" id="win-rate">0%</div>
                        </div>
                        <div class="analysis-card">
                            <h4>بیشترین سود</h4>
                            <div class="value profit" id="max-profit">$0.00</div>
                        </div>
                        <div class="analysis-card">
                            <h4>بیشترین زیان</h4>
                            <div class="value loss" id="max-loss">$0.00</div>
                        </div>
                        <div class="analysis-card">
                            <h4>نسبت سود به زیان</h4>
                            <div class="value" id="win-loss-ratio">0.00</div>
                        </div>
                    </div>
                    
                    <div class="chart-container">
                        <canvas id="performance-chart"></canvas>
                    </div>
                </div>
            </div>
            
            <div>
                <div class="trades-section">
                    <h2 class="section-title">
                        <i class="fas fa-history"></i>
                        تاریخچه معاملات
                    </h2>
                    
                    <div style="overflow-x: auto;">
                        <table id="trades-table">
                            <thead>
                                <tr>
                                    <th>نماد</th>
                                    <th>نوع</th>
                                    <th>حجم</th>
                                    <th>ورود</th>
                                    <th>خروج</th>
                                    <th>سود/زیان</th>
                                    <th>عملیات</th>
                                </tr>
                            </thead>
                            <tbody id="trades-list">
                                <!-- معاملات در اینجا نمایش داده می شوند -->
                            </tbody>
                        </table>
                    </div>
                    
                    <div id="empty-trades" class="empty-state">
                        <i class="fas fa-exchange-alt"></i>
                        <h3>هنوز معامله‌ای ثبت نشده است</h3>
                        <p>اولین معامله خود را ثبت کنید</p>
                    </div>
                </div>
                
                <div class="advanced-analysis">
                    <h2 class="section-title">
                        <i class="fas fa-chart-bar"></i>
                        آنالیز حرفه‌ای
                    </h2>
                    
                    <div class="tabs">
                        <div class="tab active" data-tab="performance">عملکرد</div>
                        <div class="tab" data-tab="risk">ریسک</div>
                        <div class="tab" data-tab="psychology">روانشناسی</div>
                    </div>
                    
                    <div class="tab-content active" id="performance-tab">
                        <div class="performance-metrics">
                            <div class="metric-card">
                                <h4>Sharpe Ratio</h4>
                                <div class="value" id="sharpe-ratio">0.00</div>
                            </div>
                            <div class="metric-card">
                                <h4>Max Drawdown</h4>
                                <div class="value loss" id="max-drawdown">0%</div>
                            </div>
                            <div class="metric-card">
                                <h4>Profit Factor</h4>
                                <div class="value" id="profit-factor">0.00</div>
                            </div>
                            <div class="metric-card">
                                <h4>Expectancy</h4>
                                <div class="value" id="expectancy">$0.00</div>
                            </div>
                        </div>
                        
                        <div class="chart-container">
                            <canvas id="equity-chart"></canvas>
                        </div>
                    </div>
                    
                    <div class="tab-content" id="risk-tab">
                        <div class="risk-metrics">
                            <div class="metric-card">
                                <h4>Risk per Trade</h4>
                                <div class="value" id="avg-risk">0%</div>
                            </div>
                            <div class="metric-card">
                                <h4>Recovery Factor</h4>
                                <div class="value" id="recovery-factor">0.00</div>
                            </div>
                            <div class="metric-card">
                                <h4>Avg R:R Ratio</h4>
                                <div class="value" id="avg-rr">0.00</div>
                            </div>
                            <div class="metric-card">
                                <h4>VaR (95%)</h4>
                                <div class="value loss" id="var">$0.00</div>
                            </div>
                        </div>
                        
                        <div class="chart-container">
                            <canvas id="risk-chart"></canvas>
                        </div>
                    </div>
                    
                    <div class="tab-content" id="psychology-tab">
                        <div class="analysis-cards">
                            <div class="analysis-card">
                                <h4>ثبات</h4>
                                <div class="value" id="consistency">0%</div>
                            </div>
                            <div class="analysis-card">
                                <h4>کنترل احساسات</h4>
                                <div class="value" id="emotional-control">0%</div>
                            </div>
                            <div class="analysis-card">
                                <h4>انضباط</h4>
                                <div class="value" id="discipline">0%</div>
                            </div>
                            <div class="analysis-card">
                                <h4>مدیریت ریسک</h4>
                                <div class="value" id="risk-management">0%</div>
                            </div>
                        </div>
                        
                        <div class="chart-container">
                            <canvas id="psychology-chart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <footer>
        <div class="container">
            <p>ژورنال حرفه ای معاملات فارکس - طراحی شده برای تریدرهای حرفه‌ای</p>
            <div class="creator-info">
                <p>تهیه کننده: <strong>علی اکبر رجبی پور حلیمه جانی</strong></p>
                <a href="https://instagram.com/ali.trade.academy" target="_blank">
                    <i class="fab fa-instagram instagram-icon"></i>
                    اینستاگرام: @ali.trade.academy
                </a>
            </div>
        </div>
    </footer>

    <script>
        // نمایش تاریخ و ساعت جاری
        function setCurrentDateTime() {
            const now = new Date();
            const year = now.getFullYear();
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const day = String(now.getDate()).padStart(2, '0');
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            
            document.getElementById('trade-date').value = `${year}-${month}-${day}T${hours}:${minutes}`;
        }
        
        setCurrentDateTime();
        
        // مدیریت تب‌ها
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                
                tab.classList.add('active');
                document.getElementById(`${tab.dataset.tab}-tab`).classList.add('active');
            });
        });
        
        // مدیریت دکمه‌های نوع معامله
        const tradeTypeBtns = document.querySelectorAll('.trade-type-btn');
        let currentTradeType = 'buy';
        
        tradeTypeBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                tradeTypeBtns.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentTradeType = btn.getAttribute('data-type');
            });
        });
        
        // مدیریت تنظیمات
        let accountSettings = JSON.parse(localStorage.getItem('accountSettings')) || {
            initialBalance: 10000,
            accountCurrency: 'USD',
            defaultSymbol: 'XAU/USD',
            riskPerTrade: 2
        };
        
        // بارگذاری تنظیمات
        function loadSettings() {
            document.getElementById('initial-balance').value = accountSettings.initialBalance;
            document.getElementById('account-currency').value = accountSettings.accountCurrency;
            document.getElementById('default-symbol').value = accountSettings.defaultSymbol;
            document.getElementById('risk-per-trade').value = accountSettings.riskPerTrade;
            document.getElementById('symbol').value = accountSettings.defaultSymbol;
            document.getElementById('current-symbol').textContent = accountSettings.defaultSymbol;
            
            updateVolumeHelpText(accountSettings.defaultSymbol);
        }
        
        // ذخیره تنظیمات
        document.getElementById('save-settings').addEventListener('click', () => {
            accountSettings = {
                initialBalance: parseFloat(document.getElementById('initial-balance').value),
                accountCurrency: document.getElementById('account-currency').value,
                defaultSymbol: document.getElementById('default-symbol').value,
                riskPerTrade: parseFloat(document.getElementById('risk-per-trade').value)
            };
            
            localStorage.setItem('accountSettings', JSON.stringify(accountSettings));
            document.getElementById('symbol').value = accountSettings.defaultSymbol;
            document.getElementById('current-symbol').textContent = accountSettings.defaultSymbol;
            
            updateVolumeHelpText(accountSettings.defaultSymbol);
            updateStats();
            
            alert('تنظیمات با موفقیت ذخیره شد.');
        });
        
        // مدیریت تغییر جفت ارز
        document.getElementById('symbol').addEventListener('change', function() {
            updateVolumeHelpText(this.value);
        });
        
        // به‌روزرسانی متن راهنمای حجم معامله
        function updateVolumeHelpText(symbol) {
            const volumeHelp = document.getElementById('volume-help');
            if (symbol === 'XAU/USD') {
                volumeHelp.textContent = 'هر 0.01 لات = 1 دلار در هر پیپ';
            } else if (symbol.includes('JPY')) {
                volumeHelp.textContent = 'هر 0.01 لات = 0.1 دلار در هر پیپ';
            } else {
                volumeHelp.textContent = 'هر 0.01 لات = 0.1 دلار در هر پیپ';
            }
        }
        
        // مدیریت فرم ثبت معامله
        const tradeForm = document.getElementById('trade-form');
        const tradesList = document.getElementById('trades-list');
        const emptyTrades = document.getElementById('empty-trades');
        
        // آرایه‌ای برای ذخیره معاملات
        let trades = JSON.parse(localStorage.getItem('forexTrades')) || [];
        
        // نمودارها
        let performanceChart, equityChart, riskChart, psychologyChart;
        
        // تابع برای ذخیره معاملات در localStorage
        function saveTrades() {
            localStorage.setItem('forexTrades', JSON.stringify(trades));
            updateStats();
            updateCharts();
        }
        
        // تابع برای به‌روزرسانی آمار
        function updateStats() {
            const totalTrades = trades.length;
            document.getElementById('total-trades').textContent = totalTrades;
            
            let netProfit = 0;
            let winningTrades = 0;
            let maxProfit = 0;
            let maxLoss = 0;
            let totalTradeTime = 0;
            let totalRisk = 0;
            let totalRR = 0;
            let rrCount = 0;
            
            // محاسبات برای آنالیز پیشرفته
            let grossProfit = 0;
            let grossLoss = 0;
            let equityData = [accountSettings.initialBalance];
            let runningProfit = 0;
            let peakEquity = accountSettings.initialBalance;
            let maxDrawdown = 0;
            
            trades.forEach(trade => {
                netProfit += trade.profitLoss;
                runningProfit += trade.profitLoss;
                equityData.push(accountSettings.initialBalance + runningProfit);
                
                // محاسبه حداکثر افت سرمایه
                const currentEquity = accountSettings.initialBalance + runningProfit;
                if (currentEquity > peakEquity) {
                    peakEquity = currentEquity;
                }
                const drawdown = ((peakEquity - currentEquity) / peakEquity) * 100;
                if (drawdown > maxDrawdown) {
                    maxDrawdown = drawdown;
                }
                
                if (trade.profitLoss > 0) {
                    winningTrades++;
                    grossProfit += trade.profitLoss;
                } else {
                    grossLoss += Math.abs(trade.profitLoss);
                }
                
                if (trade.profitLoss > maxProfit) {
                    maxProfit = trade.profitLoss;
                }
                
                if (trade.profitLoss < maxLoss) {
                    maxLoss = trade.profitLoss;
                }
                
                // محاسبه زمان معامله (به روز)
                if (trade.exitDate) {
                    const entry = new Date(trade.entryDate);
                    const exit = new Date(trade.exitDate);
                    const diffTime = Math.abs(exit - entry);
                    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                    totalTradeTime += diffDays;
                }
                
                // محاسبه ریسک و ریوارد
                if (trade.stopLoss && trade.takeProfit) {
                    const risk = Math.abs(trade.entryPrice - trade.stopLoss);
                    const reward = Math.abs(trade.takeProfit - trade.entryPrice);
                    if (risk > 0) {
                        const rrRatio = reward / risk;
                        totalRR += rrRatio;
                        rrCount++;
                    }
                    
                    // محاسبه درصد ریسک در هر معامله
                    const riskAmount = risk * getPipValue(trade.symbol, trade.volume);
                    const riskPercent = (riskAmount / (accountSettings.initialBalance + runningProfit - trade.profitLoss)) * 100;
                    totalRisk += riskPercent;
                }
            });
            
            // به روزرسانی آمار پایه
            document.getElementById('net-profit').textContent = `${formatCurrency(netProfit)}`;
            document.getElementById('net-profit').className = `value ${netProfit >= 0 ? 'profit' : 'loss'}`;
            
            const currentBalance = accountSettings.initialBalance + netProfit;
            document.getElementById('current-balance').textContent = `${formatCurrency(currentBalance)}`;
            
            const avgProfit = totalTrades > 0 ? netProfit / totalTrades : 0;
            document.getElementById('avg-profit').textContent = `${formatCurrency(avgProfit)}`;
            document.getElementById('avg-profit').className = `value ${avgProfit >= 0 ? 'profit' : 'loss'}`;
            
            const winRate = totalTrades > 0 ? (winningTrades / totalTrades * 100) : 0;
            document.getElementById('win-rate').textContent = `${winRate.toFixed(1)}%`;
            
            document.getElementById('max-profit').textContent = `${formatCurrency(maxProfit)}`;
            document.getElementById('max-loss').textContent = `${formatCurrency(maxLoss)}`;
            
            // محاسبه نسبت سود به زیان
            const lossingTrades = totalTrades - winningTrades;
            const winLossRatio = lossingTrades > 0 ? (winningTrades / lossingTrades) : (winningTrades > 0 ? winningTrades : 0);
            document.getElementById('win-loss-ratio').textContent = winLossRatio.toFixed(2);
            
            // آمار پیشرفته
            const profitFactor = grossLoss > 0 ? (grossProfit / grossLoss) : (grossProfit > 0 ? grossProfit : 0);
            document.getElementById('profit-factor').textContent = profitFactor.toFixed(2);
            
            const expectancy = totalTrades > 0 ? ((winRate/100) * (grossProfit/winningTrades) - ((100-winRate)/100) * (grossLoss/lossingTrades)) : 0;
            document.getElementById('expectancy').textContent = `${formatCurrency(expectancy)}`;
            
            document.getElementById('max-drawdown').textContent = `${maxDrawdown.toFixed(2)}%`;
            
            const avgRisk = totalTrades > 0 ? (totalRisk / totalTrades) : 0;
            document.getElementById('avg-risk').textContent = `${avgRisk.toFixed(2)}%`;
            
            const avgRR = rrCount > 0 ? (totalRR / rrCount) : 0;
            document.getElementById('avg-rr').textContent = avgRR.toFixed(2);
            
            // شاخص شارپ (ساده‌سازی شده)
            const sharpeRatio = totalTrades > 0 ? (netProfit / totalTrades) / (maxDrawdown > 0 ? maxDrawdown : 1) : 0;
            document.getElementById('sharpe-ratio').textContent = sharpeRatio.toFixed(2);
            
            // Recovery Factor
            const recoveryFactor = maxDrawdown > 0 ? (netProfit / maxDrawdown) : (netProfit > 0 ? netProfit : 0);
            document.getElementById('recovery-factor').textContent = recoveryFactor.toFixed(2);
            
            // Value at Risk (ساده‌سازی شده)
            const varValue = maxLoss * 1.65; // 95% confidence
            document.getElementById('var').textContent = `${formatCurrency(Math.abs(varValue))}`;
            
            // محاسبه امتیازات روانشناسی - رفع مشکل
            updatePsychologyScores(winRate, maxDrawdown, rrCount, totalTrades);
        }
        
        // تابع برای محاسبه امتیازات روانشناسی
        function updatePsychologyScores(winRate, maxDrawdown, rrCount, totalTrades) {
            // امتیاز ثبات
            const consistency = totalTrades > 5 ? Math.min(100, winRate * 1.2) : 0;
            document.getElementById('consistency').textContent = `${consistency.toFixed(1)}%`;
            
            // کنترل احساسات (بر اساس حداکثر افت سرمایه)
            const emotionalControl = totalTrades > 5 ? Math.max(0, Math.min(100, 100 - (maxDrawdown * 2))) : 0;
            document.getElementById('emotional-control').textContent = `${emotionalControl.toFixed(1)}%`;
            
            // انضباط (بر اساس استفاده از استاپ لاس و تیک پروفیت)
            const discipline = totalTrades > 5 ? Math.min(100, (rrCount / totalTrades) * 100) : 0;
            document.getElementById('discipline').textContent = `${discipline.toFixed(1)}%`;
            
            // مدیریت ریسک (بر اساس حداکثر افت سرمایه و میانگین ریسک)
            const riskManagement = totalTrades > 5 ? Math.max(0, Math.min(100, 100 - (maxDrawdown * 1.5))) : 0;
            document.getElementById('risk-management').textContent = `${riskManagement.toFixed(1)}%`;
            
            return {
                consistency,
                emotionalControl,
                discipline,
                riskManagement
            };
        }
        
        // تابع برای فرمت کردن ارز
        function formatCurrency(value) {
            const currencySymbol = accountSettings.accountCurrency === 'USD' ? '$' : 
                                 accountSettings.accountCurrency === 'EUR' ? '€' :
                                 accountSettings.accountCurrency === 'GBP' ? '£' :
                                 accountSettings.accountCurrency === 'JPY' ? '¥' : 'CHF';
            return `${currencySymbol}${value.toFixed(2)}`;
        }
        
        // تابع برای محاسبه ارزش هر پیپ
        function getPipValue(symbol, volume) {
            if (symbol === 'XAU/USD') {
                return volume / 0.01; // 1 دلار برای هر 0.01 لات
            } else if (symbol.includes('JPY')) {
                return volume / 0.01 * 0.1; // 0.1 دلار برای هر 0.01 لات
            } else {
                return volume / 0.01 * 0.1; // 0.1 دلار برای هر 0.01 لات برای سایر جفت‌ها
            }
        }
        
        // تابع برای به‌روزرسانی نمودارها
        function updateCharts() {
            // داده‌ها برای نمودارها
            const tradeResults = trades.map(t => t.profitLoss);
            const equityData = [accountSettings.initialBalance];
            let runningTotal = 0;
            
            trades.forEach(trade => {
                runningTotal += trade.profitLoss;
                equityData.push(accountSettings.initialBalance + runningTotal);
            });
            
            const tradeSymbols = [...new Set(trades.map(t => t.symbol))];
            const symbolProfits = {};
            
            trades.forEach(trade => {
                if (!symbolProfits[trade.symbol]) {
                    symbolProfits[trade.symbol] = 0;
                }
                symbolProfits[trade.symbol] += trade.profitLoss;
            });
            
            // نمودار عملکرد
            if (performanceChart) {
                performanceChart.destroy();
            }
            
            const performanceCtx = document.getElementById('performance-chart').getContext('2d');
            performanceChart = new Chart(performanceCtx, {
                type: 'bar',
                data: {
                    labels: Object.keys(symbolProfits),
                    datasets: [{
                        label: 'سود/زیان بر اساس نماد',
                        data: Object.values(symbolProfits),
                        backgroundColor: Object.values(symbolProfits).map(val => val >= 0 ? 'rgba(40, 167, 69, 0.7)' : 'rgba(220, 53, 69, 0.7)'),
                        borderColor: Object.values(symbolProfits).map(val => val >= 0 ? 'rgba(40, 167, 69, 1)' : 'rgba(220, 53, 69, 1)'),
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return formatCurrency(value);
                                }
                            }
                        }
                    }
                }
            });
            
            // نمودار اکوئیتی
            if (equityChart) {
                equityChart.destroy();
            }
            
            const equityCtx = document.getElementById('equity-chart').getContext('2d');
            equityChart = new Chart(equityCtx, {
                type: 'line',
                data: {
                    labels: Array.from({length: equityData.length}, (_, i) => i),
                    datasets: [{
                        label: 'منحنی سرمایه',
                        data: equityData,
                        borderColor: 'rgba(212, 175, 55, 1)',
                        backgroundColor: 'rgba(212, 175, 55, 0.1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            ticks: {
                                callback: function(value) {
                                    return formatCurrency(value);
                                }
                            }
                        }
                    }
                }
            });
            
            // نمودار ریسک
            if (riskChart) {
                riskChart.destroy();
            }
            
            const riskCtx = document.getElementById('risk-chart').getContext('2d');
            riskChart = new Chart(riskCtx, {
                type: 'doughnut',
                data: {
                    labels: ['معاملات سودده', 'معاملات زیانده'],
                    datasets: [{
                        data: [trades.filter(t => t.profitLoss > 0).length, trades.filter(t => t.profitLoss <= 0).length],
                        backgroundColor: [
                            'rgba(40, 167, 69, 0.7)',
                            'rgba(220, 53, 69, 0.7)'
                        ],
                        borderColor: [
                            'rgba(40, 167, 69, 1)',
                            'rgba(220, 53, 69, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false
                }
            });
            
            // نمودار روانشناسی
            if (psychologyChart) {
                psychologyChart.destroy();
            }
            
            const psychologyCtx = document.getElementById('psychology-chart').getContext('2d');
            
            // دریافت امتیازات روانشناسی
            const psychologyScores = {
                consistency: parseInt(document.getElementById('consistency').textContent) || 0,
                emotionalControl: parseInt(document.getElementById('emotional-control').textContent) || 0,
                discipline: parseInt(document.getElementById('discipline').textContent) || 0,
                riskManagement: parseInt(document.getElementById('risk-management').textContent) || 0
            };
            
            psychologyChart = new Chart(psychologyCtx, {
                type: 'radar',
                data: {
                    labels: ['ثبات', 'کنترل احساسات', 'انضباط', 'مدیریت ریسک'],
                    datasets: [{
                        label: 'امتیاز روانشناسی',
                        data: [
                            psychologyScores.consistency,
                            psychologyScores.emotionalControl,
                            psychologyScores.discipline,
                            psychologyScores.riskManagement
                        ],
                        backgroundColor: 'rgba(212, 175, 55, 0.2)',
                        borderColor: 'rgba(212, 175, 55, 1)',
                        pointBackgroundColor: 'rgba(212, 175, 55, 1)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgba(212, 175, 55, 1)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            angleLines: {
                                display: true
                            },
                            suggestedMin: 0,
                            suggestedMax: 100
                        }
                    }
                }
            });
        }
        
        // تابع برای نمایش معاملات در جدول
        function renderTrades() {
            tradesList.innerHTML = '';
            
            if (trades.length === 0) {
                emptyTrades.style.display = 'block';
                return;
            }
            
            emptyTrades.style.display = 'none';
            
            // مرتب سازی معاملات بر اساس تاریخ (جدیدترین اول)
            const sortedTrades = [...trades].sort((a, b) => new Date(b.entryDate) - new Date(a.entryDate));
            
            sortedTrades.forEach((trade, index) => {
                const row = document.createElement('tr');
                
                const profitLoss = trade.profitLoss;
                const profitLossClass = profitLoss >= 0 ? 'profit' : 'loss';
                const profitLossText = profitLoss >= 0 ? `+${formatCurrency(profitLoss)}` : `${formatCurrency(profitLoss)}`;
                
                row.innerHTML = `
                    <td>${trade.symbol}</td>
                    <td><span class="${trade.type === 'buy' ? 'buy-badge' : 'sell-badge'}">${trade.type === 'buy' ? 'Buy' : 'Sell'}</span></td>
                    <td>${trade.volume}</td>
                    <td>${trade.entryPrice.toFixed(trade.symbol.includes('XAU') ? 2 : 5)}</td>
                    <td>${trade.exitPrice ? trade.exitPrice.toFixed(trade.symbol.includes('XAU') ? 2 : 5) : '-'}</td>
                    <td class="${profitLossClass}">${profitLossText}</td>
                    <td>
                        <button class="action-btn edit-btn" data-index="${trades.indexOf(trade)}">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="action-btn delete-btn" data-index="${trades.indexOf(trade)}">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                
                tradesList.appendChild(row);
            });
            
            // اضافه کردن event listener برای دکمه‌های حذف و ویرایش
            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const index = e.target.closest('button').getAttribute('data-index');
                    deleteTrade(index);
                });
            });
            
            document.querySelectorAll('.edit-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const index = e.target.closest('button').getAttribute('data-index');
                    editTrade(index);
                });
            });
        }
        
        // تابع برای حذف معامله
        function deleteTrade(index) {
            if (confirm('آیا از حذف این معامله اطمینان دارید؟')) {
                trades.splice(index, 1);
                saveTrades();
                renderTrades();
            }
        }
        
        // تابع برای ویرایش معامله
        function editTrade(index) {
            const trade = trades[index];
            
            // پر کردن فرم با اطلاعات معامله
            document.getElementById('symbol').value = trade.symbol;
            document.querySelector(`.trade-type-btn.${trade.type}-btn`).click();
            document.getElementById('trade-date').value = trade.entryDate.replace(' ', 'T');
            document.getElementById('entry-price').value = trade.entryPrice;
            document.getElementById('exit-price').value = trade.exitPrice;
            document.getElementById('volume').value = trade.volume;
            document.getElementById('leverage').value = trade.leverage;
            document.getElementById('stop-loss').value = trade.stopLoss || '';
            document.getElementById('take-profit').value = trade.takeProfit || '';
            document.getElementById('swap').value = trade.swap || 0;
            document.getElementById('commission').value = trade.commission || 0;
            document.getElementById('notes').value = trade.notes || '';
            
            // حذف معامله قدیمی
            trades.splice(index, 1);
            
            // به‌روزرسانی نمایش
            saveTrades();
            renderTrades();
        }
        
        // مدیریت ارسال فرم
        tradeForm.addEventListener('submit', (e) => {
            e.preventDefault();
            
            const symbol = document.getElementById('symbol').value;
            const entryPrice = parseFloat(document.getElementById('entry-price').value);
            const exitPrice = parseFloat(document.getElementById('exit-price').value);
            const volume = parseFloat(document.getElementById('volume').value);
            
            const trade = {
                symbol: symbol,
                type: currentTradeType,
                entryDate: document.getElementById('trade-date').value,
                entryPrice: entryPrice,
                exitPrice: exitPrice,
                volume: volume,
                leverage: document.getElementById('leverage').value,
                stopLoss: document.getElementById('stop-loss').value ? parseFloat(document.getElementById('stop-loss').value) : null,
                takeProfit: document.getElementById('take-profit').value ? parseFloat(document.getElementById('take-profit').value) : null,
                swap: parseFloat(document.getElementById('swap').value) || 0,
                commission: parseFloat(document.getElementById('commission').value) || 0,
                notes: document.getElementById('notes').value
            };
            
            // محاسبه سود/زیان
            trade.profitLoss = calculateProfitLoss(trade);
            
            // تاریخ خروج (اگر معامله بسته شده باشد)
            if (exitPrice) {
                trade.exitDate = document.getElementById('trade-date').value;
            }
            
            trades.push(trade);
            saveTrades();
            renderTrades();
            
            // ریست کردن فرم
            tradeForm.reset();
            setCurrentDateTime();
            document.getElementById('symbol').value = accountSettings.defaultSymbol;
            document.getElementById('swap').value = 0;
            document.getElementById('commission').value = 0;
            updateVolumeHelpText(accountSettings.defaultSymbol);
        });
        
        // تابع برای محاسبه سود/زیان
        function calculateProfitLoss(trade) {
            // محاسبه سود/زیان بر اساس نوع معامله و حجم
            let priceDifference;
            
            if (trade.type === 'buy') {
                priceDifference = trade.exitPrice - trade.entryPrice;
            } else {
                priceDifference = trade.entryPrice - trade.exitPrice;
            }
            
            // محاسبه سود/زیان بر اساس حجم و ارزش هر پیپ
            let profitLoss = priceDifference * getPipValue(trade.symbol, trade.volume);
            
            // کسر کارمزد و سواپ
            profitLoss -= trade.commission;
            profitLoss -= trade.swap;
            
            return profitLoss;
        }
        
        // مدیریت ذخیره و بارگذاری فایل
        document.getElementById('export-btn').addEventListener('click', () => {
            const data = {
                trades: trades,
                settings: accountSettings
            };
            const dataStr = JSON.stringify(data, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `forex-trades-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
        });
        
        document.getElementById('import-btn').addEventListener('click', () => {
            document.getElementById('file-input').click();
        });
        
        document.getElementById('file-input').addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = (event) => {
                try {
                    const importedData = JSON.parse(event.target.result);
                    if (importedData.trades && Array.isArray(importedData.trades)) {
                        trades = importedData.trades;
                        if (importedData.settings) {
                            accountSettings = importedData.settings;
                            loadSettings();
                        }
                        saveTrades();
                        renderTrades();
                        alert('داده‌ها با موفقیت بارگذاری شدند.');
                    } else {
                        alert('فرمت فایل نامعتبر است.');
                    }
                } catch (error) {
                    alert('خطا در بارگذاری فایل: ' + error.message);
                }
            };
            reader.readAsText(file);
            
            // ریست کردن input فایل
            e.target.value = '';
        });
        
        // بارگذاری اولیه
        loadSettings();
        renderTrades();
        updateStats();
        updateCharts();
    </script>
</body>
</html>
